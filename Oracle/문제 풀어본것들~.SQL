================================================================================================
'이순라'와 직급이 동일한 사람들 중 '전산부'인 사람들을 검색하여 입사순으로 정렬하기
================================================================================================
subquery
================================================================================================
SELECT	*		FROM
EMPLOYEE e
WHERE
		(SELECT e2.JIKUP FROM employee e2 WHERE e2.EMP_NAME = '이순라') =	e.JIKUP AND
		(SELECT d.dep_name FROM dept d WHERE d.dep_no = e.dep_no )	= '전산부'
ORDER	BY	e.HIRE_DATE
================================================================================================
직원번호, 직원명, 나이, 입사일, 입사일 순위를 출력하기 (단, 입사일 순위를 오름차순으로 정렬)
================================================================================================
SELECT e.EMP_NO	,e.EMP_NAME,
TO_NUMBER(
	TO_CHAR(
		 SYSDATE,'YYYY'
	)
)
-
TO_NUMBER(
		CASE WHEN SUBSTR(e.JUMIN_NUM,7,1) IN('1','2')
			THEN '19' ELSE '20'
			 END||SUBSTR(
			 		e.JUMIN_NUM,1,2
			 )
 )+1 "나이",
e.HIRE_DATE,
(
		SELECT
				 COUNT(e2.EMP_NO)	+	1
		FROM
	  		 employee e2
	  WHERE
	  			e.HIRE_DATE > e2.HIRE_DATE
)
"입사일 순위"
FROM employee e
ORDER BY 5 ASC;
================================================================================================
고객번호, 고객명, 주민번호, 생일 순위를 출력하기 (단, 생일 순위를 내림차순으로 정렬)
================================================================================================
select c.CUS_NO	,c.CUS_NAME , c.JUMIN_NUM ,
(
		SELECT
		   	COUNT(*)+1
	 	FROM
	 			customer c2
	 	WHERE
	 			TO_DATE(CASE WHEN SUBSTR(c.JUMIN_NUM,7,1) IN('1','2')
	 					THEN '19'	ELSE '20' END || SUBSTR(c.JUMIN_NUM,1,6),'YYYYMMDD') >
	 					TO_DATE(CASE WHEN SUBSTR(c2.JUMIN_NUM,7,1) IN('1','2')
	 					THEN '19'	ELSE '20' END || SUBSTR(c2.JUMIN_NUM,1,6),'YYYYMMDD')
)		"생일순위"
from customer c
ORDER BY 생일순위	DESC
================================================================================================
1.고객번호, 고객명, 담당직원번호, 담당직원부서명을 출력하라.	단, 담당직원중 직속상관이 이성계인 경우만 출력
================================================================================================
select c.CUS_NO, c.CUS_NAME, e.EMP_NO, d.DEP_NAME
from customer c, EMPLOYEE e, dept d
WHERE	c.EMP_NO = e.EMP_NO	AND	e.DEP_NO = d.DEP_NO	AND	e.MGR_EMP_NO = (SELECT e2.EMP_NO	FROM employee e2 WHERE e2.emp_name = '이성계')
================================================================================================
.고객번호, 고객명, 담당직원유무, 담당직원명, 담당직원 연봉등급을 출력하라.
단, null 은 X로 표시, 담당직원유무는 담당직원번호를 이용하여 값이 있으면 O로 표시 정렬은 고객번호 내림차순
================================================================================================
SELECT	c.CUS_NO,	c.CUS_NAME, NVL2(c.EMP_NO,'O','X') "담당직원유무", NVL(e.EMP_NAME,'X'),	NVL(TO_CHAR(s.SAL_GRADE_NO),'X')
FROM
customer c,employee e, SALARY_GRADE s
WHERE
		c.EMP_NO	=	e.EMP_NO(+)	AND	e.SALARY BETWEEN s.MIN_SALARY(+) AND s.MAX_SALARY(+)
ORDER BY c.CUS_NO
================================================================================================
3.연봉 3000이상인 직원의 부하직원들의 직원번호, 직원명, 연봉, 연봉등급을 출력하라.(서브쿼리)
================================================================================================
SELECT
	  	e.EMP_NO,e.EMP_NAME,e.SALARY, (SELECT s.SAL_GRADE_NO FROM SALARY_GRADE s WHERE e.SALARY BETWEEN s.MIN_SALARY AND	s.MAX_SALARY)
FROM
employee e
WHERE e.MGR_EMP_NO IN((SELECT	e2.EMP_NO FROM employee e2 WHERE e2.SALARY >= 3000))

================================================================================================
1.이름에 김이 들어가고 10번 부서 또는 30번 부서며 급여가 1000~2000이 아닌 사원을 이름,번호,급여,부서를 출력
================================================================================================
SELECT	e.EMP_NAME,e.EMP_NO,e.SALARY,e.DEP_NO
FROM	employee e
WHERE	e.SALARY BETWEEN 1000	AND	2000	AND	dep_no	IN(10,30)	AND	e.EMP_NAME	LIKE	'%김%' or	e.EMP_NAME	LIKE	'김%' or	e.EMP_NAME	LIKE	'%김'
================================================================================================================================================================================================
2. 직속상관이 있고 직급이 사원 또는 과장이며 사원 이름에 라 또는 만이 들어가는 직원을 출력한다 <주의> 직속상관에는 널 값은 제외하고 출력한다.
================================================================================================================================================================================================
select *
from EMPLOYEE e
WHERE	e.MGR_EMP_NO IS NOT NULL
			AND	(e.JIKUP	=	'과장'	OR	e.JIKUP	=	'사원')
			AND	(e.EMP_NAME LIKE	'라%' OR	e.EMP_NAME LIKE	'%라%' OR e.EMP_NAME LIKE	'%라')	OR (e.EMP_NAME LIKE	'만%' OR	e.EMP_NAME LIKE	'%만%' OR e.EMP_NAME LIKE	'%만')
================================================================================================================================================================================================
부서번호, 직원명, 입사일 현재날짜를 출력하고 입사한 지 30년이 넘은 사람을 출력하자
================================================================================================================================================================================================
SELECT	e.DEP_NO, e.EMP_NAME, e.HIRE_DATE	, sysdate "현재날짜"
FROM	EMPLOYEE e
WHERE
			(SYSDATE - e.HIRE_DATE)/365	> 30
================================================================================================================================================================================================
4. 직원명, 입사일, 현재기준으로 입사한 지 몇개월 지났는지를 출력하라
================================================================================================================================================================================================
SELECT	e.EMP_NAME,TO_CHAR(e.HIRE_DATE,'YYYY"년"MM"월"DD"일"') "입사일",
				FLOOR(MONTHS_BETWEEN(sysdate,e.HIRE_DATE))||'개월'	"입사후 몇개월?"
FROM	employee e
================================================================================================================================================================================================
Q1. 부서명, 직원번호, 직원이름, 직급, 담당고객수를 검색.
================================================================================================================================================================================================
SELECT	d.DEP_NAME	, e.EMP_NO	,	e.EMP_NAME	,	COUNT(c.CUS_NO)
FROM	DEPT d,	EMPLOYEE e, CUSTOMER c
WHERE	e.EMP_NO = c.EMP_NO(+)	AND	d.DEP_NO = e.DEP_NO(+)
GROUP	BY	d.DEP_NAME	, e.EMP_NO	,	e.EMP_NAME
================================================================================================================================================================================================
SELECT	d.DEP_NAME	, e.EMP_NO	,	e.EMP_NAME	,	(SELECT	COUNT(c.CUS_NO) FROM customer c WHERE e.EMP_NO = c.EMP_NO)
FROM	DEPT d,	EMPLOYEE e
WHERE	d.DEP_NO = e.DEP_NO
================================================================================================================================================================================================
Q2. 담당고객이 1명인 직원번호, 직원이름, 직급, 연봉을 검색.
================================================================================================================================================================================================
SELECT	e.EMP_NO, e.EMP_NAME, e.JIKUP, e.SALARY
FROM	EMPLOYEE e
WHERE	(SELECT COUNT(c.CUS_NO) FROM CUSTOMER c WHERE e.EMP_NO = c.EMP_NO	) = 1
================================================================================================================================================================================================
Q3. 직급명, 직급직원수, 직급담당고객수 검색.
================================================================================================================================================================================================
================================================================================================================================================================================================
JOIN
================================================================================================================================================================================================
SELECT	e.JIKUP, COUNT(DISTINCT e.EMP_NO)"직급직원수",
	  		  		  COUNT(c.CUS_NO)	"직급담당고객수"
FROM	EMPLOYEE e, DEPT d, CUSTOMER c
WHERE e.DEP_NO = d.DEP_NO(+)	AND	e.EMP_NO = c.EMP_NO(+)
GROUP BY e.JIKUP
================================================================================================================================================================================================
subquery
================================================================================================================================================================================================